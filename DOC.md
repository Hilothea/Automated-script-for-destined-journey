## 模块结构

### 1. 配置模块 (`config.js`)
- **版本/更新时间**: v0.1/25.9.24
- **功能**: 管理所有游戏配置常量
- **包含内容**:
  - `MILESTONE_LEVELS`: 里程碑等级配置
  - `JOB_LEVEL_XP_TABLE`: 职业等级经验表
  - `GAME_CONFIG`: 核心游戏配置参数

### 2. 工具函数 (`utils.js`)
- **版本/更新时间**: v0.1/25.9.24
- **功能**: 提供通用工具函数
- **包含内容**:
  - `safeParseFloat()`: 安全的浮点数解析
  - `uninject()`: 解除注入功能

### 3. 经验等级处理 (`experience-level.js`)
- **版本/更新时间**: v0.1/25.9.24
- **功能**: 处理角色经验值和等级提升
- **主要函数**: `experiencegrowth(user)`
- **特性**:
  - 自动升级处理
  - 属性点获得
  - 里程碑奖励
  - 升级提示注入

### 4. 属性校准 (`attribute-calibration.js`);暂时弃用
- **版本/更新时间**: v0.1/25.9.24
- **功能**: 计算和校准角色的HP、MP、SP
- **主要函数**: `attributecalibration(user)`
- **特性**:
  - 基础属性计算
  - 倍率和额外值处理
  - 上限值校准
  
### 5. 货币系统 (`currency-system.js`)
- **作者注**: v0.2不是我写的是Claude写的
- **版本/更新时间**: v0.2/25.9.26
- **功能**: 处理游戏内货币按需换算（无自动进位）
- **主要函数**: `CurrencySystem(property)`
- **特性**:
  - **按需换算逻辑**: 
    - PP购买：PP被扣成负时，优先用GP抵扣，GP不足则尝试用SP换GP，SP不足则尝试用CP换SP
    - GP购买：GP被扣成负时，优先用PP抵扣，PP不足则尝试用SP换GP，SP不足则尝试用CP换SP
    - SP/CP购买：按相同逻辑处理
  - **换算比例**: 1 PP = 100 GP = 1000 SP = 10000 CP
  - **不足处理**: 能覆盖→完成换算；不能覆盖→PP、GP、SP清零，差值记录为负CP（表示欠债）
  - **破产提醒**: 使用injectPrompts播报详细差值信息
  - **测试支持**: 包含currency-test.html测试页面

### 6. 信息注入 (`info-injection.js`)
- **版本/更新时间**: v0.1/25.9.24
- **功能**: 向游戏注入环境信息
- **主要函数**: `inforead(world)`
- **特性**:
  - 地点信息注入
  - 时间信息注入

### 7. 事件链系统 (`event-chain-system.js`)
- **版本/更新时间**: v0.1/25.9.24
- **功能**: 管理游戏事件链
- **主要函数**:
  - `event_chain(eventchain)`: 处理事件链
- **特性**:
  - 事件链激活/停用
  - 状态跟踪
  - 提示注入

### 8. 关键等级检测 (`Key_level.js`)
- **版本/更新时间**: v0.2/25.9.26
- **功能**: 检测用户是否达到关键等级阈值
- **主要函数**: `Key_level(user)`
- **特性**:
  - 关键等级阈值检测（默认60级）
  - 自动系统提示注入
  - 可配置阈值设置

### 9. 主流程控制 (`main-controller.js`)
- **版本/更新时间**: v0.2/25.9.26
- **功能**: 协调所有模块的执行
- **主要函数**: `Main_processes(variables)`
- **特性**:
  - 模块执行顺序控制
  - 事件监听器注册
  - 错误处理

## 使用方法

### 单独使用模块
每个模块都可以独立使用：

```javascript
// 例如：只使用货币系统
// 在主流程控制模块中使用//注释不需要启用的模块
//例如:
window.uninject();                           // 1. 解除注入
//window.experiencegrowth(user);               // 2. 经验与等级处理
window.CurrencySystem(property);             // 3. 货币换算
//window.inforead(world);                      // 4. 信息读取与注入
//window.event_chain(eventchain);              // 6. 事件链处理
//window.Key_level(user);                      // 7. 关键等级检测
```

## 兼容性说明

- 所有模块都使用 `window` 对象来暴露函数，确保跨模块访问

## 维护优势

1. **模块化**: 每个功能独立，便于维护和调试
2. **可复用**: 模块可以在其他项目中重复使用
3. **清晰结构**: 代码组织更加清晰
4. **易于扩展**: 可以轻松添加新功能模块
5. **版本控制**: 可以独立更新各个模块

## 注意事项

- 确保按正确顺序加载脚本
- 所有模块都依赖于 `config.js` 和 `utils.js`
- `main-controller.js` 包含事件监听器，必须最后加载
- 如果修改配置，只需要更新 `config.js` 文件
